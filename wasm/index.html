<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>

<body>
	<style type="text/css">
		 textarea {
		 width: 100%;
		 resize: vertical;
		}
	</style>
	<div >
		<button onclick="bclick()">Click</button>
		<textarea id="textin" rows="5"></textarea>
		<textarea id="textout" rows="5"></textarea>
	</div>
	<div >
	<button onclick="bevaluate()">Evaluate</button>
	</div>
	<div >
	<textarea id="texta" name="texta" rows="5" columns="100" style="color:white;background-color:grey;" spellcheck="false"></textarea>
	</div>
	<div>
	<textarea id="output" name="output" rows="5" columns="100" style="color:yellow;background-color:black;" readonly></textarea>
	</div>
	<!-- glue-code generated by emscripten -->
	<script src="cppmain.js"></script>
	<script>
	<!-- called just after the WASM file is loaded -->
	Module['onRuntimeInitialized'] = function(){
		textin.value = 'wasm OK';
		texta.value+='\n';
		texta.value+= 'var c1=new complex(1,2);';
		texta.value+='\n var cI=new complex(0,1);';
		texta.value+= '\n output.value=c1;';
		texta.value+= '\n output.value+=c1.times(c1);';
		texta.value+= '\n output.value+=cI.times(cI);'; 
	}
	function point(x,y) // type point with 2 attributes x/y
	{
		this.x=x;
		this.y=y;
		this.toString=function(){ //used for string outputs
			return '('+this.x+','+this.y+')';
		}
	}

	<!-- click handler -->
	function bclick(){
		//call the exposed function
		textout.value= Module.modifyStr('aaaaa') + "\n";
		/*********************************/
		//call the f1,f2,f3,f4,f5 function
		textout.value="f1(4,7)=";
		textout.value+= Module.f1(4,7) + "\n";
		textout.value+="f2(2.5,1.5)=";
		textout.value+= Module.f2(2.5,1.5) + "\n";
		textout.value+="f3('exponential')=";
		textout.value+= Module.f3('exponential') + "\n";
		var tab=[12,5,27,4,2]; // an array in JS
		textout.value+="f4(tab)=";
		textout.value+= Module.f4(tab) + "\n";
		textout.value+="f5(7)=";
		var tab2=Module.f5(7); // returns an array
		textout.value+= tab2 + "\n";
		/*********************************/
		//call the f6,f7,f8 function
		var tab=['ab','cde','fgh','ijkl'];
		textout.value+="f6(tab)=";
		textout.value+= Module.f6(tab) + "\n";
		textout.value+="f7(point)=";
		var p=new point(10,13); // JS object
		textout.value+= Module.f7(p) + "\n";
		textout.value+="f8(object)=";
		var otherP=Module.f8(16,23); // creates an object point from func8 C++/WASM
		textout.value+= otherP + "\n";
		textout.value+= JSON.stringify(p); // JSON string description for p
		textout.value+= JSON.stringify(otherP)+'\n';; // p and otherP are 2 JS objects point
		/*********************************/
		//call the f9,f10 function
		var p=new point(13,17);
		textout.value+="f9(point)=";
		textout.value+=Module.f9(p)+'\n';
		textout.value+="f10()=";
		var pE=Module.f10(15,22); // 'general' JS object without specific type
		var pN = Object.assign(new point,pE); // creates a point object with a copy of the values of pE
		textout.value+=pN; // calls pN.toString() 
	}
	
	// kind of JS class to be wrapped to std::complex
	function complex(r,i)
	{
		this.r=r;
		this.i=i;
		this.plus=function(c){ return Module.cplus(this,c); }
		this.times=function(c){ return Module.ctimes(this,c); }
		this.toString=function(){ return Module.cstring(this); }
	}
	<!-- click handler -->
	function bevaluate(){
		// evaluate the first textarea as javascript code
		try{ eval(texta.value); }
		catch(error){ output.value=error;}
	}
	</script>
</body>
</html>
